<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Authentasaurus::Ar::Authenticatable::ClassMethods</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../../../../css/reset.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../../../css/main.css" type="text/css" media="screen" />
    <script src="../../../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../../js/main.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>     
    <div class="banner">
        <h1>
            <span class="type">Module</span> 
            Authentasaurus::Ar::Authenticatable::ClassMethods 
            
        </h1>
        <ul class="files">
            
            <li><a href="../../../../files/lib/authentasaurus/ar/authenticatable_rb.html">lib/authentasaurus/ar/authenticatable.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    

    

    
    

    
    
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
    
        <dt>A</dt>
        <dd>
            <ul>
                
                <li><a href="#M000007">authenticatable</a></li>
                
            </ul>
        </dd>
    
    </dl>
    

    
    <div class="sectiontitle">Included Modules</div>
    <ul>
        
        <li>
            
            <a href="../ActsAsAuthenticatable.html">Authentasaurus::Ar::ActsAsAuthenticatable</a>
            
            START:includes
        </li>
        
        <li>
            
            <a href="../ActsAsAuthenticatable.html">Authentasaurus::Ar::ActsAsAuthenticatable</a>
            
            START:includes
        </li>
        
    </ul>
    

    

    

    

    
    <div class="sectiontitle">Attributes</div>
    <table border='0' cellpadding='5'>
        
        <tr valign='top'>
            <td class='attr-rw'>
                [RW]
            </td>
            <td class='attr-name'>default_data</td>
            <td class='attr-desc'></td>
        </tr>
        
    </table>
    

    
            <div class="sectiontitle">Instance Public methods</div>
            
            <div class="method">
                <div class="title" id="M000007">
                    
                    <a name="M000007"></a><b>authenticatable</b>(*args)
                    
                </div>
                
                
                
                
                <div class="sourcecode">
                    <p class="source-link">
                        Source: <a href="javascript:toggleSource('M000007_source')" id="l_M000007_source">show</a>
                        
                    </p>
                    <div id="M000007_source" class="dyn-source">
                        <pre><span class="ruby-comment cmt"># File lib/authentasaurus/ar/authenticatable.rb, line 8</span>
      <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">authenticatable</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
        <span class="ruby-identifier">options</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">extract_options!</span>
        <span class="ruby-identifier">args</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">flatten</span>
        <span class="ruby-comment cmt"># Associations</span>
        <span class="ruby-identifier">belongs_to</span> <span class="ruby-identifier">:group</span>
        <span class="ruby-identifier">has_many</span> <span class="ruby-identifier">:permissions</span>, <span class="ruby-identifier">:through</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:group</span>
        <span class="ruby-comment cmt"># Validation</span>
        <span class="ruby-comment cmt"># basic attributes</span>
        <span class="ruby-identifier">validates_presence_of</span> <span class="ruby-identifier">:username</span>, <span class="ruby-identifier">:hashed_password</span>, <span class="ruby-identifier">:password_seed</span>, <span class="ruby-identifier">:email</span>, <span class="ruby-identifier">:name</span>
        <span class="ruby-identifier">validates_uniqueness_of</span> <span class="ruby-identifier">:username</span>, <span class="ruby-identifier">:email</span>
        <span class="ruby-identifier">validates_format_of</span> <span class="ruby-identifier">:username</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp re">/^[a-z0-9]*([a-z0-9]{4})+[a-z0-9]*$/</span> <span class="ruby-comment cmt"># alpha-numeric only and at least 4 characters</span>
        <span class="ruby-identifier">validates_format_of</span> <span class="ruby-identifier">:email</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp re">%r{[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}}</span>
        <span class="ruby-comment cmt"># password validations</span>
        <span class="ruby-identifier">validates_confirmation_of</span> <span class="ruby-identifier">:password</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:create</span>, <span class="ruby-identifier">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">user</span><span class="ruby-operator">|</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">hashed_password</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">password_seed</span>.<span class="ruby-identifier">nil?</span> }
        <span class="ruby-identifier">validates_presence_of</span> <span class="ruby-identifier">:password</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:create</span>, <span class="ruby-identifier">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">user</span><span class="ruby-operator">|</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">hashed_password</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">password_seed</span>.<span class="ruby-identifier">nil?</span> }
        <span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:password</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">6</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:create</span>, <span class="ruby-identifier">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">user</span><span class="ruby-operator">|</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">hashed_password</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">password_seed</span>.<span class="ruby-identifier">nil?</span> }
        <span class="ruby-comment cmt"># new password</span>
        <span class="ruby-identifier">validates_confirmation_of</span> <span class="ruby-identifier">:new_password</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:update</span>, <span class="ruby-identifier">:unless</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:new_password_blank?</span>
        <span class="ruby-identifier">validates_length_of</span> <span class="ruby-identifier">:new_password</span>, <span class="ruby-identifier">:minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">6</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:update</span>, <span class="ruby-identifier">:unless</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:new_password_blank?</span>
        <span class="ruby-comment cmt"># format of password</span>
        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">:strong_password</span>)
          <span class="ruby-identifier">validates_format_of</span> <span class="ruby-identifier">:password</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp re">%r{[a-z]}</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:create</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:&quot;authenticatable.lower_case_password&quot;</span>, <span class="ruby-identifier">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">user</span><span class="ruby-operator">|</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">hashed_password</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">password_seed</span>.<span class="ruby-identifier">nil?</span> }
          <span class="ruby-identifier">validates_format_of</span> <span class="ruby-identifier">:password</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp re">%r{[A-Z]}</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:create</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:&quot;authenticatable.upper_case_password&quot;</span>, <span class="ruby-identifier">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">user</span><span class="ruby-operator">|</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">hashed_password</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">password_seed</span>.<span class="ruby-identifier">nil?</span> }
          <span class="ruby-identifier">validates_format_of</span> <span class="ruby-identifier">:password</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp re">%r{[0-9]}</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:create</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:&quot;authenticatable.digit_password&quot;</span>, <span class="ruby-identifier">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">user</span><span class="ruby-operator">|</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">hashed_password</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">password_seed</span>.<span class="ruby-identifier">nil?</span> }
          <span class="ruby-identifier">validates_format_of</span> <span class="ruby-identifier">:password</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp re">%r{[@$%!&amp;]}</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:create</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:&quot;authenticatable.symbol_password&quot;</span>, <span class="ruby-identifier">:if</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">user</span><span class="ruby-operator">|</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">hashed_password</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">password_seed</span>.<span class="ruby-identifier">nil?</span> }
          <span class="ruby-comment cmt"># new password</span>
          <span class="ruby-identifier">validates_format_of</span> <span class="ruby-identifier">:new_password</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp re">%r{[a-z]}</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:update</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:&quot;authenticatable.lower_case_password&quot;</span>, <span class="ruby-identifier">:unless</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:new_password_blank?</span>
          <span class="ruby-identifier">validates_format_of</span> <span class="ruby-identifier">:new_password</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp re">%r{[A-Z]}</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:update</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:&quot;authenticatable.upper_case_password&quot;</span>, <span class="ruby-identifier">:unless</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:new_password_blank?</span>
          <span class="ruby-identifier">validates_format_of</span> <span class="ruby-identifier">:new_password</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp re">%r{[0-9]}</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:update</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:&quot;authenticatable.digit_password&quot;</span>, <span class="ruby-identifier">:unless</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:new_password_blank?</span>
          <span class="ruby-identifier">validates_format_of</span> <span class="ruby-identifier">:new_password</span>, <span class="ruby-identifier">:with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp re">%r{[@$%!&amp;]}</span>, <span class="ruby-identifier">:on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:update</span>, <span class="ruby-identifier">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:&quot;authenticatable.symbol_password&quot;</span>, <span class="ruby-identifier">:unless</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:new_password_blank?</span>
        <span class="ruby-keyword kw">end</span>
        
        <span class="ruby-comment cmt"># Accessors</span>
        <span class="ruby-identifier">attr_accessor</span> <span class="ruby-identifier">:password_confirmation</span>, <span class="ruby-identifier">:new_password_confirmation</span>
        
        <span class="ruby-comment cmt"># default data</span>
        <span class="ruby-keyword kw">class</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-keyword kw">self</span>
          <span class="ruby-identifier">attr_accessor</span> <span class="ruby-identifier">:default_data</span>
        <span class="ruby-keyword kw">end</span>
        
        <span class="ruby-ivar">@default_data</span> = {}
        
        <span class="ruby-comment cmt"># dont delete admin</span>
        <span class="ruby-identifier">before_destroy</span> <span class="ruby-identifier">:dont_delete_admin</span>
        
        <span class="ruby-comment cmt">#validation</span>
        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">:validatable</span>)
          <span class="ruby-identifier">has_one</span> <span class="ruby-identifier">:validation</span>, <span class="ruby-identifier">:as</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:user</span>
          <span class="ruby-identifier">after_create</span> <span class="ruby-identifier">:send_validation</span>
          <span class="ruby-comment cmt"># include authentication methods including validation</span>
          <span class="ruby-identifier">include</span> <span class="ruby-constant">ActsAsAuthenticatableValidatable</span>
        <span class="ruby-keyword kw">else</span>
          <span class="ruby-comment cmt"># include authentication methods</span>
          <span class="ruby-identifier">include</span> <span class="ruby-constant">ActsAsAuthenticatable</span>
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">end</span></pre>
                    </div>
                </div>
                
            </div>
            
</div>
    </div>
  </body>
</html>    